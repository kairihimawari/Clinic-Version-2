<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Abortion Clinic - Philippines</title>
  <link rel="stylesheet" href="Style.css">
</head>
<body>
  <header>
    <a href="index.html" class="logo-link">
        <img src="https://i.imgur.com/T7BxxLm.jpeg" alt="Clinic Logo" class="logo-img">
        <span class="logo-text">Abortion Clinic Philippines</span>
    </a>
    <nav>
      <a href="index.html">Home</a>
      <a href="services.html">Services</a>
      <a href="team.html">Team</a>
      <a href="contact.html">Contact</a>
    </nav>
    <button class="menu-toggle" onclick="document.querySelector('nav').classList.toggle('show')">‚ò∞</button>
</header>

<main class="container">
  <h2 style="text-align:center; color:#023e8a;">Order Medicines & Appointments</h2>

  <!-- Medicine Order Form -->
  <div class="order-section">
    <form id="orderForm" onsubmit="submitOrder(event)">
      <h3 style="color:#023e8a;">Order Medicines</h3>

      <label for="medicineSet" style="font-weight:bold; color:#023e8a;">Select Medicine Set:</label>
      <select id="medicineSet" name="medicineSet" required onchange="updatePrice()">
        <option value="" disabled selected>Select a set</option>
        <option value="Set 1" data-price="3500">Set 1 - ‚Ç±3,500 (0-2 Months)</option>
        <option value="Set 2" data-price="4500">Set 2 - ‚Ç±4,500 (2-4 Months)</option>
        <option value="Set 3" data-price="5800">Set 3 - ‚Ç±5,800 (4-5 Months)</option>
        <option value="Set 4" data-price="6800">Set 4 - ‚Ç±6,800 (5-6 Months)</option>
        <option value="Set 5" data-price="7800">Set 5 - ‚Ç±7,800 (6-8 Months)</option>
      </select>

      <label for="shippingMethod" style="font-weight:bold; color:#023e8a; margin-top:1em;">Select Shipping/Payment Method:</label>
      <select id="shippingMethod" name="shippingMethod" required onchange="updatePrice()">
        <option value="" disabled selected>Select a method</option>
        <option value="free" data-fee="0">Free Shipping</option>
        <option value="cod" data-fee="500">Cash on Delivery (‚Ç±500 Shipping Fee)</option>
        <option value="installment" data-fee="500">Installment (‚Ç±500 Shipping Fee)</option>
      </select>

      <p class="total-price" style="font-weight:bold; color:#023e8a; text-align:center; margin-top:1em;">
        Total Price: ‚Ç±0.00
      </p>

      <h4 style="color:#023e8a;">Your Details</h4>
      <input type="text" name="fullName" placeholder="Full Name" required>
      <input type="email" name="email" placeholder="Email Address" required>
      <input type="text" name="contactNumber" placeholder="Contact Number" required>
      <textarea name="address" placeholder="Delivery Address (if applicable)" rows="3"></textarea>

      <label for="referenceNumber" style="margin-top:1em;">GCash Reference Number (if applicable):</label>
      <input type="text" name="referenceNumber" placeholder="GCash Reference Number">

      <button type="submit" style="margin-top:1em; background:#0077b6; color:#fff;">Confirm Medicine Order</button>
    </form>
  </div>

  <hr style="margin: 2em 0;">

  <!-- Appointment Booking Form -->
  <div class="appointment-section">
    <form id="appointmentForm" onsubmit="submitAppointment(event)">
      <h3 style="color:#023e8a;">Appointment for Clinical Procedure</h3>

      <input type="text" name="fullName" placeholder="Full Name" required>
      <input type="email" name="email" placeholder="Email Address" required>
      <input type="text" name="contactNumber" placeholder="Contact Number" required>

      <label for="appointmentDate">Preferred Date:</label>
      <input type="date" id="appointmentDate" name="appointmentDate" required>

      <label for="appointmentTime">Preferred Time:</label>
      <input type="time" id="appointmentTime" name="appointmentTime" required>

      <button type="submit" style="margin-top:1em; background:#0096c7; color:#fff;">Book Appointment</button>
    </form>
  </div>
</main>

<script>
  // Calculate price (updated to handle partial selections)
  function updatePrice() {
    const medicineSelect = document.getElementById('medicineSet');
    const shippingSelect = document.getElementById('shippingMethod');
    const totalPriceElem = document.querySelector('.total-price');

    if (!medicineSelect.value) {
      totalPriceElem.textContent = 'Total Price: ‚Ç±0.00';
      return;
    }

    let basePrice = parseFloat(medicineSelect.selectedOptions[0].dataset.price);
    let shippingFee = 0;
    let tax = basePrice * 0.12; // Start with tax on base only
    let total = basePrice + shippingFee + tax;

    // If shipping is selected, add it and recalculate tax
    if (shippingSelect.value) {
      shippingFee = parseFloat(shippingSelect.selectedOptions[0].dataset.fee);
      tax = (basePrice + shippingFee) * 0.12;
      total = basePrice + shippingFee + tax;
    }

    if (shippingSelect.value === 'installment') {
      const downpayment = (basePrice / 2) + shippingFee;
      const interest = downpayment * 0.20; 
      const installmentAmount = downpayment + interest;
      // Include full total (with tax) for clarity
      totalPriceElem.innerHTML = `
        <strong>Installment Plan (Total with Tax: ‚Ç±${total.toFixed(2)}):</strong><br>
        Downpayment (50% + shipping): ‚Ç±${downpayment.toFixed(2)}<br>
        Interest (20%): ‚Ç±${interest.toFixed(2)}<br>
        Total per installment (every 15 days): ‚Ç±${installmentAmount.toFixed(2)}
      `;
    } else {
      // Standard display: base + shipping (if any) + tax
      const shippingText = shippingSelect.value ? ` + Shipping ‚Ç±${shippingFee}` : '';
      totalPriceElem.textContent = 
        `Total Price: Base ‚Ç±${basePrice}${shippingText} + Tax ‚Ç±${tax.toFixed(2)} = ‚Ç±${total.toFixed(2)}`;
    }
  }

  // Submit medicine order (unchanged, but now uses updated logic for consistency)
  function submitOrder(event) {
    event.preventDefault();
    const form = document.getElementById('orderForm');
    const medicineSelect = form.elements["medicineSet"];
    const shippingSelect = form.elements["shippingMethod"];

    if (!medicineSelect.value || !shippingSelect.value) {
      alert("Please select both a medicine set and shipping method.");
      return;
    }

    const basePrice = parseFloat(medicineSelect.selectedOptions[0].dataset.price);
    const shippingFee = parseFloat(shippingSelect.selectedOptions[0].dataset.fee);
    const tax = (basePrice + shippingFee) * 0.12;
    const total = basePrice + shippingFee + tax;

    const orderData = {
      fullName: form.elements["fullName"].value,
      email: form.elements["email"].value,
      contactNumber: form.elements["contactNumber"].value,
      address: form.elements["address"].value || "N/A",
      referenceNumber: form.elements["referenceNumber"].value || "N/A",
      medicineName: medicineSelect.value,
      shippingMethod: shippingSelect.value,
      basePrice,
      shippingFee,
      tax: tax.toFixed(2),
      total: total.toFixed(2)
    };

    emailjs.send("service_jmbaoq6", "template_ddebyrp", orderData)
      .then(() => {
        alert(`‚úÖ Order placed successfully for ${orderData.medicineName}.\nTotal: ‚Ç±${orderData.total}\nYou will be contacted soon.`);
        form.reset();
        document.querySelector('.total-price').textContent = 'Total Price: ‚Ç±0.00';
      })
      .catch(error => {
        alert("‚ùå Failed to send order. Please try again later.");
        console.error("EmailJS Error:", error);
      });
  }

  // Submit appointment booking (unchanged)
  function submitAppointment(event) {
    event.preventDefault();
    const form = document.getElementById('appointmentForm');

    const appointmentData = {
      fullName: form.elements["fullName"].value,
      email: form.elements["email"].value,
      contactNumber: form.elements["contactNumber"].value,
      appointmentDate: form.elements["appointmentDate"].value,
      appointmentTime: form.elements["appointmentTime"].value
    };

    emailjs.send("service_jmbaoq6", "template_appointment", appointmentData)
      .then(() => {
        alert(`‚úÖ Appointment booked successfully on ${appointmentData.appointmentDate} at ${appointmentData.appointmentTime}.\nYou will be contacted soon.`);
        form.reset();
      })
      .catch(error => {
        alert("‚ùå Failed to book appointment. Please try again later.");
        console.error("EmailJS Error:", error);
      });
  }
</script>

<!-- QR Code Modal -->
<div id="qrModal" class="qr-modal">
  <div class="qr-modal-content">
    <span class="close-btn" onclick="closeQRModal()">&times;</span>
    <h3>Scan to Pay</h3>
    <p>Use GCash or your preferred app to scan and pay:</p>
    <img src="https://i.imgur.com/EfcyDsq.jpeg/" alt="GCash QR Code" class="qr-img">
  </div>
</div>

<style>
.qr-modal {
  display: none;
  position: fixed;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.7);
}
.qr-modal-content {
  background: white;
  margin: 10% auto;
  padding: 20px;
  border-radius: 12px;
  width: 300px;
  text-align: center;
  position: relative;
}
.qr-img {
  width: 200px;
  height: 200px;
  margin-top: 10px;
}
.close-btn {
  position: absolute;
  top: 8px;
  right: 12px;
  font-size: 24px;
  cursor: pointer;
}
</style>

<script>
// Show QR modal
function showQRModal() {
  document.getElementById("qrModal").style.display = "block";
}

// Close QR modal
function closeQRModal() {
  document.getElementById("qrModal").style.display = "none";
}

// Override existing order submission
function submitOrder(event) {
  event.preventDefault();
  showQRModal(); // Show QR for payment
}

// Override appointment booking
function submitAppointment(event) {
  event.preventDefault();
  showQRModal(); // Show QR for payment
}
</script>


 <footer>
    <p>¬© 2005 Our Clinic | All Rights Reserved</p>
    <div class="footer-links">
      <a href="index.html">Home</a> | 
      <a href="services.html">Services</a> | 
      <a href="team.html">Team</a> | 
      <a href="contact.html">Contact</a>
    </div>
    <div class="footer-contact">
      üìç Para√±aque City, Manila, Philippines <br>
      ‚òé +63 991 435 2751<br>
      ‚úâ abortionclinicphilippines@gmail.com
    </div>
    <div class="social-links">
      <a href="https://wa.me/+639914352751" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" alt="WhatsApp"></a>
      <a href="viber://chat?number=%2B+639914352751" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/viber.svg" alt="Viber"></a>
      <a href="https://t.me/+639121847959" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/telegram.svg" alt="Telegram"></a>
      <a href="https://www.facebook.com/profile.php?id=61579580193066" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg" alt="Facebook"></a>
    </div>
  </footer>
</body>
</html>
